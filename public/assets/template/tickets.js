!function(t){function e(i){if(n[i])return n[i].exports;var s=n[i]={i:i,l:!1,exports:{}};return t[i].call(s.exports,s,s.exports,e),s.l=!0,s.exports}var n={};e.m=t,e.c=n,e.d=function(t,n,i){e.o(t,n)||Object.defineProperty(t,n,{configurable:!1,enumerable:!0,get:i})},e.n=function(t){var n=t&&t.__esModule?function(){return t.default}:function(){return t};return e.d(n,"a",n),n},e.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},e.p="",e(e.s=346)}({346:function(t,e,n){"use strict";var i={initialize:function(){"function"!=typeof window.prettyPrint&&($.getScript(TicketsConfig.jsUrl+"lib/prettify/prettify.js",function(){prettyPrint()}),$("<link/>",{rel:"stylesheet",type:"text/css",href:TicketsConfig.jsUrl+"lib/prettify/prettify.css"}).appendTo("head")),jQuery().ajaxForm||document.write('<script src="'+TicketsConfig.jsUrl+'lib/jquery.form.min.js"><\/script>'),jQuery().jGrowl||document.write('<script src="'+TicketsConfig.jsUrl+'lib/jquery.jgrowl.min.js"><\/script>'),jQuery().sisyphus||document.write('<script src="'+TicketsConfig.jsUrl+'lib/jquery.sisyphus.min.js"><\/script>'),$(document).on("click","#comment-preview-placeholder a",function(){return!1}),$(document).on("change","#comments-subscribe",function(){i.comment.subscribe($('[name="thread"]',$("#comment-form")))}),$(document).on("change","#tickets-subscribe",function(){i.ticket.subscribe($(this).data("id"))}),$(document).on("submit","#ticketForm",function(t){return i.ticket.save(this,$(this).find('[type="submit"]')[0]),t.preventDefault(),!1}),$(document).on("submit","#comment-form",function(t){return i.comment.save(this,$(this).find('[type="submit"]')[0]),t.preventDefault(),!1}),$(document).on("click touchend","#ticketForm .preview, #ticketForm .save, #ticketForm .draft, #ticketForm .publish",function(t){return $(this).hasClass("preview")?i.ticket.preview(this.form,this):i.ticket.save(this.form,this),t.preventDefault(),!1}),$(document).on("click touchend","#comment-form .preview, #comment-form .submit",function(t){return $(this).hasClass("preview")?i.comment.preview(this.form,this):i.comment.save(this.form,this),t.preventDefault(),!1}),$(document).on("keydown","#ticketForm, #comment-form",function(t){13==t.keyCode&&(t.shiftKey&&(t.ctrlKey||t.metaKey)?$(this).submit():(t.ctrlKey||t.metaKey)&&$(this).find('input[type="button"].preview').click())}),$(document).on("click touchend","#comment-new-link a",function(t){return i.forms.comment(),t.preventDefault(),!1}),$(document).on("click touchend",".comment-reply a",function(t){var e=$(this).parents(".ticket-comment").data("id");return $(this).hasClass("reply")?i.forms.reply(e):$(this).hasClass("edit")&&i.forms.edit(e),t.preventDefault(),!1}),$(document).on("click touchend",".ticket-comment-rating.active > .vote",function(t){var e=$(this).parents(".ticket-comment").data("id");return $(this).hasClass("plus")?i.Vote.comment.vote(this,e,1):$(this).hasClass("minus")&&i.Vote.comment.vote(this,e,-1),t.preventDefault(),!1}),$(document).on("click touchend",".ticket-rating.active > .vote",function(t){var e=$(this).parents(".ticket-meta").data("id");return $(this).hasClass("plus")?i.Vote.ticket.vote(this,e,1):$(this).hasClass("minus")?i.Vote.ticket.vote(this,e,-1):i.Vote.ticket.vote(this,e,0),t.preventDefault(),!1}),$(document).on("click touchend",".ticket-comment-star.active > .star",function(t){var e=$(this).parents(".ticket-comment").data("id");return i.Star.comment.star(this,e,0),t.preventDefault(),!1}),$(document).on("click touchend",".ticket-star.active > .star",function(t){var e=$(this).parents(".ticket-meta").data("id");return i.Star.ticket.star(this,e,0),t.preventDefault(),!1}),$(document).ready(function(){1==TicketsConfig.enable_editor&&$("#ticket-editor").markItUp(TicketsConfig.editor.ticket),1==TicketsConfig.enable_editor&&$("#comment-editor").markItUp(TicketsConfig.editor.comment),$.jGrowl.defaults.closerTemplate="<div>[ "+TicketsConfig.close_all_message+" ]</div>";var t=$(".ticket-comment").length;$("#comment-total, .ticket-comments-count").text(t),$("#ticketForm.create").sisyphus({excludeFields:$("#ticketForm .disable-sisyphus")}),$("#comment-form").is(":visible")&&$("#comment-new-link").hide()}),$("#comments").on("click touchend",".ticket-comment-up a",function(){var t=$(this).data("id"),e=$(this).data("parent");return e&&t&&(i.utils.goto("comment-"+e),$("#comment-"+e+" .ticket-comment-down:lt(1)").show().find("a").attr("data-child",t)),!1}),$("#comments").on("click touchend",".ticket-comment-down a",function(){var t=$(this).data("child");return t&&i.utils.goto("comment-"+t),$(this).attr("data-child","").parent().hide(),!1})},ticket:{preview:function(t,e){$(t).ajaxSubmit({data:{action:"ticket/preview"},url:TicketsConfig.actionUrl,form:t,button:e,dataType:"json",beforeSubmit:function(){return $(e).attr("disabled","disabled"),!0},success:function(t){$(document).trigger("tickets_ticket_preview",t);var n=$("#ticket-preview-placeholder");t.success?(n.html(t.data.preview).show(),prettyPrint()):(n.html("").hide(),i.Message.error(t.message)),$(e).removeAttr("disabled")}})},save:function(t,e){var n="ticket/";switch($(e).prop("name")){case"draft":n+="draft";break;case"save":n+="save";break;default:n+="publish"}$(t).ajaxSubmit({data:{action:n},url:TicketsConfig.actionUrl,form:t,button:e,dataType:"json",beforeSubmit:function(){return $(t).find('input[type="submit"], input[type="button"]').attr("disabled","disabled"),$(".error",t).text(""),!0},success:function(e){if($(document).trigger("tickets_ticket_save",e),$("#ticketForm.create").sisyphus().manuallyReleaseData(),e.success)e.message&&i.Message.success(e.message),"ticket/save"==n?($(t).find('input[type="submit"], input[type="button"]').removeAttr("disabled"),e.data.content&&$("#ticket-editor").val(e.data.content),$("#ticket-files-list").find(".deleted").each(function(){$(this).remove()})):e.data.redirect&&(document.location.href=e.data.redirect);else if($(t).find('input[type="submit"], input[type="button"]').removeAttr("disabled"),i.Message.error(e.message),e.data){var s,a;for(s in e.data){a=e.data[s],$(t).find('[name="'+a.field+'"]').parent().find(".error").text(a.message);var o=$(t).find('[name="'+a.field+'"]').parent().find(".error");o.length||(o=$(t).find("#"+a.field+"-error")),o.length&&o.text(a.message)}}}})},subscribe:function(t){t&&$.post(TicketsConfig.actionUrl,{action:"section/subscribe",section:t},function(t){t.success?i.Message.success(t.message):i.Message.error(t.message)},"json")}},comment:{preview:function(t,e){return $(t).ajaxSubmit({data:{action:"comment/preview"},url:TicketsConfig.actionUrl,form:t,button:e,dataType:"json",beforeSubmit:function(){return $(e).attr("disabled","disabled"),!0},success:function(t){$(document).trigger("tickets_comment_preview",t),$(e).removeAttr("disabled"),t.success?($("#comment-preview-placeholder").html(t.data.preview).show(),prettyPrint()):i.Message.error(t.message)}}),!1},save:function(t,e){return $(t).ajaxSubmit({data:{action:"comment/save"},url:TicketsConfig.actionUrl,form:t,button:e,dataType:"json",beforeSubmit:function(){return clearInterval(window.timer),$(".error",t).text(""),$(e).attr("disabled","disabled"),!0},success:function(n){if($(e).removeAttr("disabled"),$(document).trigger("tickets_comment_save",n),n.success)i.forms.comment(!1),$("#comment-preview-placeholder").html("").hide(),$("#comment-editor",t).val(""),$(".ticket-comment .comment-reply a").show(),!n.data.length&&n.message?i.Message.info(n.message):(i.comment.insert(n.data.comment),i.utils.goto($(n.data.comment).attr("id"))),i.comment.getlist(),prettyPrint();else if(i.Message.error(n.message),n.data){var s,a,o=[];for(s in n.data){a=n.data[s];var r=$(t).find('[name="'+a.field+'"]').parent().find(".error");r.length||(r=$(t).find("#"+a.field+"-error")),r.length?r.text(a.message):a.field&&a.message&&o.push(a.field+": "+a.message)}o.length&&i.Message.error(o.join("<br/>"))}n.data.captcha&&($('input[name="captcha"]',t).val("").focus(),$("#comment-captcha",t).text(n.data.captcha))}}),!1},getlist:function(){var t=$("#comment-form"),e=$('[name="thread"]',t);return!!e&&(i.tpanel.start(),$.post(TicketsConfig.actionUrl,{action:"comment/getlist",thread:e.val()},function(t){for(var e in t.data.comments)t.data.comments.hasOwnProperty(e)&&i.comment.insert(t.data.comments[e],!0);var n=$(".ticket-comment").length;$("#comment-total, .ticket-comments-count").text(n),i.tpanel.stop()},"json"),!0)},insert:function(t,e){var n=$(t),i=$(n).attr("data-parent"),s=$(n).attr("id"),a=$("#"+s),o="";if(a.length>0){var r=a.data("newparent");if(n.attr("data-newparent",r),t=n[0].outerHTML,!e)return void a.replaceWith(t);o=a.find(".comments-list").html(),a.remove()}if(0==i&&TicketsConfig.formBefore)$("#comments").prepend(t);else if(0==i)$("#comments").append(t);else{var c=$("#comment-"+i);if(c.data("parent")!=c.data("newparent"))i=c.data("newparent"),n.attr("data-newparent",i),t=n[0].outerHTML;else if(TicketsConfig.thread_depth){var m=c.parents(".ticket-comment").length;m>0&&m>=TicketsConfig.thread_depth-1&&(i=c.data("parent"),n.attr("data-newparent",i),t=n[0].outerHTML)}$("#comment-"+i+" > .comments-list").append(t)}o.length>0&&$("#"+s).find(".comments-list").html(o)},subscribe:function(t){t.length&&$.post(TicketsConfig.actionUrl,{action:"comment/subscribe",thread:t.val()},function(t){t.success?i.Message.success(t.message):i.Message.error(t.message)},"json")}},forms:{reply:function(t){$("#comment-new-link").show(),clearInterval(window.timer);var e=$("#comment-form");$(".time",e).text(""),$(".ticket-comment .comment-reply a").show(),$("#comment-preview-placeholder").hide(),$('input[name="parent"]',e).val(t),$('input[name="id"]',e).val(0);var n=$("#comment-"+t+" > .comment-reply");return e.insertAfter(n).show(),$("a",n).hide(),n.parents(".ticket-comment").removeClass("ticket-comment-new"),$("#comment-editor",e).val("").focus(),!1},comment:function(t){!1!==t&&(t=!0),clearInterval(window.timer),$("#comment-new-link").hide();var e=$("#comment-form");return $(".time",e).text(""),$(".ticket-comment .comment-reply a:hidden").show(),$("#comment-preview-placeholder").hide(),$('input[name="parent"]',e).val(0),$('input[name="id"]',e).val(0),$(e).insertAfter("#comment-form-placeholder").show(),$("#comment-editor",e).val(""),t&&$("#comment-editor",e).focus(),!1},edit:function(t){$("#comment-new-link").show();var e=$('#comment-form [name="thread"]').val();return $.post(TicketsConfig.actionUrl,{action:"comment/get",id:t,thread:e},function(e){if(e.success){clearInterval(window.timer),$(".ticket-comment .comment-reply a:hidden").show();var n=$("#comment-form");$("#comment-preview-placeholder").hide(),$('input[name="parent"]',n).val(0),$('input[name="id"]',n).val(t);var s=$("#comment-"+t+" > .comment-reply"),a=$(".time",n);a.text(""),n.insertAfter(s).show(),$("a",s).hide(),$("#comment-editor",n).val(e.data.raw).focus(),e.data.name&&$('[name="name"]',n).val(e.data.name),e.data.email&&$('[name="email"]',n).val(e.data.email);var o=e.data.time;window.timer=setInterval(function(){o>0?(o-=1,a.text(i.utils.timer(o))):(clearInterval(window.timer),a.text(""))},1e3)}else i.Message.error(e.message)},"json"),!1}},utils:{timer:function(t){days=Math.floor(t/86400),hours=Math.floor(t/3600),mins=Math.floor(t/60),secs=Math.floor(t),dd=days,hh=hours-24*days,mm=mins-60*hours,ss=secs-60*mins;var e=[];return hh>0&&e.push(hh?this.addzero(hh):"00"),e.push(mm?this.addzero(mm):"00"),e.push(ss?this.addzero(ss):"00"),e.join(":")},addzero:function(t){return t<10?"0"+t:t},goto:function(t){$("html, body").animate({scrollTop:$("#"+t).offset().top},1e3)}}};i.Message={success:function(t){t&&$.jGrowl(t,{theme:"tickets-message-success"})},error:function(t){t&&$.jGrowl(t,{theme:"tickets-message-error"})},info:function(t){t&&$.jGrowl(t,{theme:"tickets-message-info"})},close:function(){$.jGrowl("close")}},i.Vote={comment:{options:{active:"active",inactive:"inactive",voted:"voted",vote:"vote",rating:"rating",positive:"positive",negative:"negative"},vote:function(t,e,n){t=$(t);var s=t.parent(),a=this.options,o=s.find("."+a.rating);return!s.hasClass(a.inactive)&&($.post(TicketsConfig.actionUrl,{action:"comment/vote",id:e,value:n},function(e){e.success?(t.addClass(a.voted),s.removeClass(a.active).addClass(a.inactive),s.find("."+a.vote),o.text(e.data.rating).attr("title",e.data.title),o.removeClass(a.positive+" "+a.negative),1==e.data.status?o.addClass(a.positive):-1==e.data.status&&o.addClass(a.negative)):i.Message.error(e.message)},"json"),!0)}},ticket:{options:{active:"active",inactive:"inactive",voted:"voted",vote:"vote",rating:"rating",positive:"positive",negative:"negative"},vote:function(t,e,n){t=$(t);var s=t.parent(),a=this.options,o=s.find("."+a.rating);return!s.hasClass(a.inactive)&&($.post(TicketsConfig.actionUrl,{action:"ticket/vote",id:e,value:n},function(e){e.success?(t.addClass(a.voted),s.removeClass(a.active).addClass(a.inactive),s.find("."+a.vote),o.text(e.data.rating).attr("title",e.data.title).removeClass(a.vote),o.removeClass(a.positive+" "+a.negative),1==e.data.status?o.addClass(a.positive):-1==e.data.status&&o.addClass(a.negative)):i.Message.error(e.message)},"json"),!0)}}},i.Star={comment:{options:{stared:"stared",unstared:"unstared"},star:function(t,e,n){t=$(t);var s=this.options;t.parent();return $.post(TicketsConfig.actionUrl,{action:"comment/star",id:e},function(e){e.success?t.toggleClass(s.stared).toggleClass(s.unstared):i.Message.error(e.message)},"json"),!0}},ticket:{options:{stared:"stared",unstared:"unstared",count:"ticket-star-count"},star:function(t,e,n){t=$(t);var s=this.options,a=t.parent().find("."+this.options.count);return $.post(TicketsConfig.actionUrl,{action:"ticket/star",id:e},function(e){e.success?(t.toggleClass(s.stared).toggleClass(s.unstared),a.text(e.data.stars)):i.Message.error(e.message)},"json"),!0}}},i.tpanel={wrapper:$("#comments-tpanel"),refresh:$("#tpanel-refresh"),new_comments:$("#tpanel-new"),class_new:"ticket-comment-new",initialize:function(){TicketsConfig.tpanel&&(this.wrapper.show(),this.stop()),this.refresh.on("click",function(){$("."+i.tpanel.class_new).removeClass(i.tpanel.class_new),i.comment.getlist()}),this.new_comments.on("click",function(){var t=$("."+i.tpanel.class_new+":first");$("html, body").animate({scrollTop:t.offset().top},1e3,"linear",function(){t.removeClass(i.tpanel.class_new)});var e=parseInt(i.tpanel.new_comments.text());e>1?i.tpanel.new_comments.text(e-1):i.tpanel.new_comments.text("").hide()})},start:function(){this.refresh.addClass("loading")},stop:function(){var t=$("."+this.class_new).length;t>0?this.new_comments.text(t).show():this.new_comments.hide(),this.refresh.removeClass("loading")}},"undefined"!=typeof TicketsConfig&&(i.initialize(),i.tpanel.initialize())}});